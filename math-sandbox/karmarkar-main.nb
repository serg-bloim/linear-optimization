(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     15514,        391]
NotebookOptionsPosition[     14771,        362]
NotebookOutlinePosition[     15115,        377]
CellTagsIndexPosition[     15072,        374]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", " ", "karmarkar`"}], "\n", 
 RowBox[{"<<", " ", "karmarkarAdvanced`"}], "\n", 
 RowBox[{"<<", " ", "customFuncs`"}], "\n", 
 RowBox[{
  RowBox[{"cf", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eps", " ", "=", " ", "0.0001"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"itermax", " ", "=", " ", "400"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"hardIterMax", " ", "=", " ", "400"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"breakOnExactSolution", " ", "=", " ", "False"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BreakOnItermax", "[", "iter_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"NumberQ", "[", "itermax", "]"}], " ", "&&", " ", 
    RowBox[{"iter", " ", ">=", " ", "itermax"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BreakOnVectorDiff", "[", 
    RowBox[{"xPrev_", ",", " ", "xCur_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"MaxAbs", "[", 
     RowBox[{"xCur", " ", "-", " ", "xPrev"}], "]"}], " ", "<", " ", 
    RowBox[{"Abs", "[", "eps", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BreakOnExactOptimum", "[", "x_", "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"breakOnExactSolution", " ", "&&", "\n", "   ", 
    RowBox[{"IsOptimalKarmarkar", "[", 
     RowBox[{
      RowBox[{"getExactSolution", "[", 
       RowBox[{
        RowBox[{"N", "[", "x", "]"}], ",", " ", "restrictions"}], "]"}], ",", 
      " ", "a", ",", " ", "cf"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KAlgorithmNew", "[", "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xk", ",", " ", "x0", ",", " ", "n", ",", " ", "m", ",", " ", "r", ",", 
       " ", "alp", ",", " ", 
       RowBox[{"isoptimum", " ", "=", " ", "0"}], ",", "\n", "    ", 
       "cfunc"}], "}"}], ",", " ", 
     RowBox[{"(*", 
      RowBox[{
      "itermax_integer", " ", "will", " ", "be", " ", "50", " ", "by", " ", 
       "default", " ", "if", " ", "it", " ", 
       RowBox[{"is", " ", "\\\n", "omitted"}]}], "*)"}], "\n", "   ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", " ", "n"}], "}"}], " ", "=", " ", 
       RowBox[{"Dimensions", "[", "a", "]"}]}], ";", "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"'", 
         RowBox[{"[", "a", "]"}], "'"}], " ", "must", " ", "be", " ", "a", 
        " ", "full", " ", "array"}], "*)"}], "\n", "   ", 
      RowBox[{"restrictions", " ", "=", " ", 
       RowBox[{"composeRestrictions", "[", "a", "]"}]}], ";", "\n", "   ", 
      RowBox[{"xk", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"1", "/", "n"}], ",", " ", 
         RowBox[{"{", "n", "}"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"'", 
        RowBox[{"Table", "'"}], " ", "generates", " ", "a", " ", "list", " ", 
        "of", " ", "n", " ", "copies", " ", 
        RowBox[{"of", " ", "'"}], 
        RowBox[{"1", "/", "\n", "   ", 
         RowBox[{"n", "'"}]}], " ", "so", " ", "we", " ", "have", " ", "a", 
        " ", "vector", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", "n"}], ",", 
          RowBox[{"...", 
           RowBox[{"1", "/", "n"}]}]}], ")"}], " ", "with", " ", "n", " ", 
        "elements"}], "*)"}], "\n", "   ", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", "*", 
          RowBox[{"(", 
           RowBox[{"n", " ", "-", " ", "1"}], ")"}]}], "]"}]}]}], ";", "\n", 
      "   ", 
      RowBox[{"alp", " ", "=", " ", 
       RowBox[{"2", "/", "9"}]}], ";", "\n", "   ", 
      RowBox[{"iter", " ", "=", " ", "0"}], ";", "\n", "   ", 
      RowBox[{"iters", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\n", "   ", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"iter", " ", "<", " ", "hardIterMax"}], ",", "\n", "   ", 
        RowBox[{
         RowBox[{"iter", "++"}], ";", "\n", "    ", 
         RowBox[{"x0", " ", "=", " ", "xk"}], ";", "\n", "    ", 
         RowBox[{"xk", " ", "=", " ", 
          RowBox[{
           RowBox[{"KIter", "[", 
            RowBox[{
            "xk", ",", " ", "a", ",", " ", "cf", ",", " ", "alp", ",", " ", 
             "r"}], "]"}], " ", "//", " ", "N"}]}], ";", "\n", "    ", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"iters", ",", " ", "xk"}], "]"}], ";", "\n", "    ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"BreakOnItermax", "[", "iter", "]"}], ",", " ", 
           RowBox[{"Return", "[", "\"\<maxiter\>\"", "]"}]}], "]"}], ";", 
         "\n", "    ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"BreakOnVectorDiff", "[", 
            RowBox[{"x0", ",", " ", "xk"}], "]"}], ",", " ", 
           RowBox[{"Return", "[", "\"\<vector_diff\>\"", "]"}]}], "]"}], ";", 
         "\n", "    ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"BreakOnExactOptimum", "[", " ", "xk", "]"}], ",", " ", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"iters", ",", 
              RowBox[{"getExactSolution", "[", 
               RowBox[{
                RowBox[{"N", "[", "xk", "]"}], ",", " ", "restrictions"}], 
               "]"}]}], "]"}], ";", 
            RowBox[{"Return", "[", "\"\<exact_optimum\>\"", "]"}]}]}], "]"}], 
         ";"}]}], "\n", "    ", "]"}], ";", "\n", "   ", 
      RowBox[{"Return", "[", "\"\<absolute_maxiter\>\"", "]"}], ";"}]}], "\n",
     "   ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"TestFunc", "[", "]"}], ":=", "42"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7357657329362264`*^9, 3.7357657890596437`*^9}, {
   3.735765856777918*^9, 3.7357658574495063`*^9}, {3.73576595280275*^9, 
   3.7357659533544135`*^9}, 3.73576602054201*^9, 3.735772670675366*^9, 
   3.7357741233882427`*^9, {3.7357743200310745`*^9, 3.735774343888377*^9}, {
   3.7357743847971687`*^9, 3.7357743913271484`*^9}, {3.735774497668625*^9, 
   3.735774556452402*^9}, {3.7357746076908283`*^9, 3.735774679348673*^9}, {
   3.735774819758157*^9, 3.7357750015421457`*^9}, {3.7357750659834423`*^9, 
   3.735775161057863*^9}, {3.735775205460497*^9, 3.7357753172446203`*^9}, {
   3.735775372780399*^9, 3.7357753831420164`*^9}, {3.73577631751499*^9, 
   3.7357763840030165`*^9}, {3.735776445748976*^9, 3.7357764459748354`*^9}, {
   3.735776512562805*^9, 3.7357765153620806`*^9}, 3.735776575060296*^9, {
   3.735779271130616*^9, 3.7357792718731585`*^9}, {3.7357793280925245`*^9, 
   3.7357793283993306`*^9}, {3.735779606764812*^9, 3.7357796355280848`*^9}, 
   3.735779883691173*^9, 3.735780797058378*^9, {3.7357824692280293`*^9, 
   3.7357824775688915`*^9}, {3.7357825104966063`*^9, 
   3.7357825121186028`*^9}, {3.735782548751033*^9, 3.73578254990232*^9}, {
   3.735783439934905*^9, 3.7357834440004005`*^9}, {3.7358536694500074`*^9, 
   3.735853691342516*^9}, {3.735854091773798*^9, 3.7358541923478317`*^9}, {
   3.7358550936144943`*^9, 3.735855094153158*^9}, {3.7358551844525175`*^9, 
   3.73585518829615*^9}, 3.735858154352545*^9, {3.735951244173103*^9, 
   3.7359512539670677`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cf", "=", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "1", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "8"}], ",", 
         RowBox[{"-", "2"}], ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "22"}], ",", "10", ",", "125", ",", "0", ",", "0", ",", 
         RowBox[{"-", "103"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "10", ",", 
         RowBox[{"-", "3"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
          ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"-", "11"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", 
         RowBox[{"-", "8"}], ",", "0", ",", 
         RowBox[{"-", "9"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
          ",", "0", ",", "0", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "16"}], ",", 
         RowBox[{"-", "2"}], ",", "0", ",", "0", ",", 
         RowBox[{"-", "7"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
          ",", "0", ",", "25"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "2", ",", "6", ",", 
         RowBox[{"-", "20"}], ",", "10", ",", "0", ",", "0", ",", "2"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "10", ",", 
         RowBox[{"-", "8"}], ",", 
         RowBox[{"-", "5"}], ",", "0", ",", "2", ",", "0", ",", "1"}], 
        "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eps", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"itermax", "=", "400"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"breakOnExactSolution", "=", "True"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "Print", "[", 
     "\"\<\:0420\:0435\:0448\:0435\:043d\:0438\:0435 \:043e\:0431\:044b\:0447\
\:043d\:044b\:043c \:043c\:0435\:0442\:043e\:0434\:043e\:043c \:041a\:0430\
\:0440\:043c\:0430\:0440\:043a\:0430\:0440\:0430\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"KAresult", "=", 
    RowBox[{"KAlgorithmNew", "[", "]"}]}], "\[IndentingNewLine]", "iter", 
   "\[IndentingNewLine]", 
   RowBox[{"sol", "=", 
    RowBox[{
     RowBox[{"iters", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "//", "N"}]}]}]}]], "Input",
 CellChangeTimes->{{3.735766014245889*^9, 3.735766014544707*^9}, 
   3.7357726126531186`*^9, {3.735772740705216*^9, 3.735772758239414*^9}, 
   3.735776493480564*^9, 3.735780862135281*^9, 3.7358300285594482`*^9, {
   3.735852011966753*^9, 3.735852020326603*^9}, {3.7358520511006393`*^9, 
   3.7358520538709364`*^9}, {3.735853006252103*^9, 3.735853070517501*^9}, 
   3.7358531854067097`*^9, {3.735853321362936*^9, 3.7358533215528193`*^9}, {
   3.735855071217289*^9, 3.7358550785297856`*^9}, 3.7358551133053555`*^9, {
   3.735855198073125*^9, 3.735855199434285*^9}}],

Cell[BoxData["\<\"\:0420\:0435\:0448\:0435\:043d\:0438\:0435 \:043e\:0431\
\:044b\:0447\:043d\:044b\:043c \:043c\:0435\:0442\:043e\:0434\:043e\:043c \
\:041a\:0430\:0440\:043c\:0430\:0440\:043a\:0430\:0440\:0430\"\>"], "Print",
 CellChangeTimes->{
  3.7358533223933015`*^9, {3.7358551073280416`*^9, 3.735855113954956*^9}, {
   3.735855193018239*^9, 3.7358552007494755`*^9}}],

Cell[BoxData["\<\"exact_optimum\"\>"], "Output",
 CellChangeTimes->{
  3.7358533225092297`*^9, {3.7358551077717657`*^9, 3.7358551143657036`*^9}, {
   3.73585519343998*^9, 3.73585520116422*^9}}],

Cell[BoxData["146"], "Output",
 CellChangeTimes->{
  3.7358533225092297`*^9, {3.7358551077717657`*^9, 3.7358551143657036`*^9}, {
   3.73585519343998*^9, 3.7358552011662183`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.12337820820379783`", ",", "0.21010448770215492`", ",", 
   "0.5072652490691302`", ",", "0.03192463008341851`", ",", 
   "0.006262151849585365`", ",", "0.0007414375958333256`", ",", 
   "0.006313769573837201`", ",", "0.011968172606110682`", ",", 
   "0.0004950329918549196`", ",", "0.00270641443921543`", ",", 
   "0.0013166311005745547`", ",", "0.09752381478448707`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7358533225092297`*^9, {3.7358551077717657`*^9, 3.7358551143657036`*^9}, {
   3.73585519343998*^9, 3.735855201169217*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"restr", "=", 
   RowBox[{"composeRestrictions", "[", "a", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{"getExactSolution", "[", 
   RowBox[{"sol", ",", " ", "restr"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"IsOptimalKarmarkar", "[", 
  RowBox[{
   RowBox[{"getExactSolution", "[", 
    RowBox[{"sol", ",", " ", "restr"}], "]"}], ",", "a", ",", "cf"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7358533295698833`*^9, 3.7358533599341726`*^9}, {
   3.7358535947554827`*^9, 3.7358536170247574`*^9}, {3.7358536571575794`*^9, 
   3.7358536581769514`*^9}, 3.7358537039357567`*^9, {3.7358540241364565`*^9, 
   3.7358540244222794`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1425", "12827"], ",", 
   FractionBox["2850", "12827"], ",", 
   FractionBox["7220", "12827"], ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["60", "12827"], ",", 
   FractionBox["132", "12827"], ",", "0", ",", "0", ",", "0", ",", 
   FractionBox["1140", "12827"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.73578254195022*^9, {3.7358300139694347`*^9, 3.7358300297117343`*^9}, {
   3.735852007327612*^9, 3.735852028563526*^9}, {3.735853057797339*^9, 
   3.7358530713949604`*^9}, {3.7358533316585946`*^9, 3.735853360515813*^9}, 
   3.7358536181960363`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.73578254195022*^9, {3.7358300139694347`*^9, 3.7358300297117343`*^9}, {
   3.735852007327612*^9, 3.735852028563526*^9}, {3.735853057797339*^9, 
   3.7358530713949604`*^9}, {3.7358533316585946`*^9, 3.735853360515813*^9}, 
   3.735853618200034*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "0.11109378654400873", ",", "0.22218757308801745", ",", 
    "0.5628751851563109", ",", "0.0", ",", "0.0", ",", "0.0", ",", 
    "0.004677633117642473", ",", "0.01029079285881344", ",", "0.0", ",", 
    "0.0", ",", "0.0", ",", "0.08887502923520699"}], "}"}], ".", 
  "cf"}]], "Input",
 CellChangeTimes->{{3.7358555316375923`*^9, 3.7358555349435573`*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{3.735855535615141*^9}]
}, Open  ]]
},
WindowSize->{707, 506},
WindowMargins->{{7, Automatic}, {Automatic, 29}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 7426, 170, 852, "Input"],
Cell[CellGroupData[{
Cell[8008, 194, 3233, 75, 312, "Input"],
Cell[11244, 271, 374, 5, 23, "Print"],
Cell[11621, 278, 193, 3, 31, "Output"],
Cell[11817, 283, 178, 3, 31, "Output"],
Cell[11998, 288, 578, 11, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12613, 304, 698, 16, 72, "Input"],
Cell[13314, 322, 616, 13, 48, "Output"],
Cell[13933, 337, 301, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14271, 347, 409, 9, 72, "Input"],
Cell[14683, 358, 72, 1, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
